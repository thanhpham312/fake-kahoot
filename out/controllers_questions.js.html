<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: controllers/questions.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: controllers/questions.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>const opentdb = require('../models/opentdb')
const user = require('../models/users')
const pointPerQuestion = 500
const streakBonus = 200

/**
 *
 */
class Questions {
  /**
   *
   */
  constructor () {
    this.questionsList = []
    this.minimalquestionsList = []
    this.currentQuestion = 0
  }

  /**
   * Gets a list of questions with the answer property removed.
   * @param numberofQuestions
   * @param category
   * @param difficulty
   * @param questionType
   * @returns {Promise&lt;any>}
   */
  getQuestions (numberofQuestions = '10', category = '11', difficulty = 'medium', questionType = 'multiple') {
    return new Promise((resolve, reject) => {
      opentdb.getQuestions(numberofQuestions, category, difficulty, questionType).then((result) => {
        this.questionsList = result
        this.minimalquestionsList = []
        for (let i = 0; i &lt; result.length; i++) {
          this.minimalquestionsList.push({
            'index': i,
            'question': result[i].question,
            'option1': result[i].option1,
            'option2': result[i].option2,
            'option3': result[i].option3,
            'option4': result[i].option4
          })
        }
        resolve(this.minimalquestionsList)
      })
    })
  }

  /**
   * assessQuestionResult checks if user made the right choice by looking at the answer stored server-side.
   * @param userObject Object that contains current user's data including username, score, streak, etc.
   * @param questionNumber The current question to be assessed.
   * @param chosenAnswer The choice made by the user for the current question.
   * @returns {{result: boolean, currentUser: *}} Object dictating whether the answer if right or wrong and the current user's data.
   */
  assessQuestionResult (userObject, questionNumber, chosenAnswer) {
    if (this.questionsList[questionNumber].answers === Number(chosenAnswer)) {
      userObject.currentScore.userScore += pointPerQuestion + streakBonus * userObject.currentScore.currentStreak
      userObject.currentScore.currentStreak++
      if (userObject.currentScore.currentStreak > userObject.currentScore.highestStreak) {
        userObject.currentScore.highestStreak = userObject.currentScore.currentStreak
      }

      return {
        'result': true,
        'currentUser': userObject.toJSON()
      }
    } else {
      userObject.currentScore.currentStreak = 0
      return {
        'result': false,
        'currentUser': userObject.toJSON()
      }
    }
  }

  /**
   * @deprecated using a database now
   * storeQuizResult store current user results with date, score, streak, username to the database
   * @param userObject Current user who played the game
   */
  storeQuizResult (userObject) {
    let date = new Date()
    let timeStamp = `${date.getDate()}/${date.getMonth() + 1}/${date.getFullYear()} ${date.getHours()}:${date.getMinutes()}:${date.getSeconds()}`

    user.storeUser(userObject.username, userObject.currentScore.userScore, userObject.currentScore.highestStreak, timeStamp)
  }
}

/**
 * Exports the Questions Class
 * @type {{Questions: Questions}}
 */
module.exports = {
  Questions
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Questions.html">Questions</a></li><li><a href="Score.html">Score</a></li><li><a href="User.html">User</a></li><li><a href="Users.html">Users</a></li><li><a href="%257Bstring%257D%2520this.fileName.html">fileName</a></li></ul><h3>Global</h3><ul><li><a href="global.html#displayNotification">displayNotification</a></li><li><a href="global.html#displayQuestion">displayQuestion</a></li><li><a href="global.html#getNextQuestion">getNextQuestion</a></li><li><a href="global.html#getQuestionByCategory">getQuestionByCategory</a></li><li><a href="global.html#getQuestions">getQuestions</a></li><li><a href="global.html#getQuestionsNewApi">getQuestionsNewApi</a></li><li><a href="global.html#playAsGuest">playAsGuest</a></li><li><a href="global.html#populatePopupResult">populatePopupResult</a></li><li><a href="global.html#request">request</a></li><li><a href="global.html#startTrivia">startTrivia</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Sun May 13 2018 09:35:51 GMT-0700 (PDT)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
